SELECT  *FROM  "BRIGHT_COFFEE_SHOP"."BRIGHT_COFFEE_SHOP"."BRIGHT_COFFEE_SHOP"LIMIT  10;

  SELECT MIN (TRANSACTION_TIME)
  FROM "BRIGHT_COFFEE_SHOP"."BRIGHT_COFFEE_SHOP"."BRIGHT_COFFEE_SHOP";

  SELECT MAX (TRANSACTION_TIME)
  FROM "BRIGHT_COFFEE_SHOP"."BRIGHT_COFFEE_SHOP"."BRIGHT_COFFEE_SHOP";
  
SELECT  *FROM  "BRIGHT_COFFEE_SHOP"."BRIGHT_COFFEE_SHOP"."BRIGHT_COFFEE_SHOP"LIMIT  10;
  ---Time buckets hour interval by Early rush, Pre work boost, work start spile, late wind down and create a Column called TRANSACTION_TIME_BUCKETS

SELECT 
  TRANSACTION_DATE,
  to_char(to_date(transaction_date, 'YYYY-MM-DD'), 'YYYYMM')as month_id,
  COUNT(TRANSACTION_ID) AS NUMBER_OF_SALES,
  COUNT(DISTINCT PRODUCT_ID) AS UNIQUE_PRODUCTS_SOLD,
  SUM(TRANSACTION_QTY * TO_NUMBER(REPLACE(UNIT_PRICE, ',', ''))) AS TOTAL_AMOUNT,
  PRODUCT_CATEGORY,
  PRODUCT_DETAIL,
  PRODUCT_TYPE,
  STORE_LOCATION,
  CASE
    WHEN TRANSACTION_TIME BETWEEN '06:00:00' AND '06:29:59' THEN 'Early Rush'
    WHEN TRANSACTION_TIME BETWEEN '06:30:00' AND '06:59:59' THEN 'Pre-Work Boost'
    WHEN TRANSACTION_TIME BETWEEN '07:00:00' AND '07:29:59' THEN 'Work Start Spike'
    WHEN TRANSACTION_TIME BETWEEN '20:30:00' AND '20:59:59' THEN 'Late Wind Down'
    ELSE 'Very Late'
  END AS TRANSACTION_TIME_BUCKETS
FROM "BRIGHT_COFFEE_SHOP"."BRIGHT_COFFEE_SHOP"."BRIGHT_COFFEE_SHOP"
GROUP BY ALL
ORDER BY TRANSACTION_DATE ASC;
